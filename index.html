<!DOCTYPE >
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<script src="js/mui.min.js"></script>
		<link href="css/mui.min.css" rel="stylesheet" />
		<script type="text/javascript" charset="utf-8">
			mui.init();
		</script>
	</head>
	<body>


		<!-- 主界面移动、菜单不动 -->
		<div class="mui-off-canvas-wrap mui-draggable">
			<!-- 菜单容器 -->
			<aside class="mui-off-canvas-left" id="offCanvasSide">
				<div class="mui-scroll-wrapper">
					<div class="mui-scroll">
						<!-- 菜单具体展示内容 -->

					</div>
				</div>
			</aside>
			<!-- 主页面容器 -->
			<div class="mui-inner-wrap">
				<!-- 主页面标题 -->
				<header class="mui-bar mui-bar-nav">
					<a class="mui-icon mui-action-menu mui-icon-bars mui-pull-left" href="#offCanvasSide"></a>
					<h1 class="mui-title">首页</h1>
				</header>

				<div class="mui-content mui-scroll-wrapper">
					<div class="mui-scroll">

						<div id="slider" class="mui-slider">
							<div id="imgShow" class="mui-slider-group mui-slider-loop">


								<div class="mui-slider-item mui-slider-item-duplicate">
									<a href="#">
										<img src="http:\/\/placehold.it\/400x300">
									</a>
								</div>
							</div>
							<div id="divShow" class="mui-slider-indicator">
							</div>
						</div>

						<br />

						<p>今日热闻</p>

						<!-- 新闻数据渲染	 -->
						<ul id="content" class="mui-table-view">

						</ul>


					</div>
				</div>
				<div class="mui-off-canvas-backdrop"></div>
			</div>
		</div>



		<script src="js/jquery-1.11.3.js"></script>

		<script type="text/javascript" charset="utf-8">
			$.ajax({
				type: "get",
				url: "https://news-at.zhihu.com/api/4/news/latest",
				dataType: "json",
				success: function(data) {


					console.log(data);

					var html = "";
					var divHtml = "";
					$.each(data.top_stories, function(index, obj) {

						if (index == 0) {
							divHtml += "<div class='mui-indicator mui-active'></div>";
							
							html += "<div class='mui-slider-item mui-slider-item-duplicate'>";
							html += "<a href=''>";
							html += "<img src='" + obj.image + "'>";
							html += "</a>";
							html += "</div>";
						} else {
							divHtml += "<div class='mui-indicator'></div>";

							if (index != data.top_stories.length - 1) {
								html += "<div class='mui-slider-item'>";
								html += "<a href='#'>";
								html += "<img src='" + obj.image + "'>";
								html += "</a>";
								html += "</div>";
							} else {
								html += "<div class='mui-slider-item mui-slider-item-duplicate'>";
								html += "<a href=''>";
								html += "<img src='" + obj.image + "'>";
								html += "</a>";
								html += "  </div>";

							}
						}

					});

					$("#divShow").html(divHtml);
					$("#imgShow").html(html);

					var content = "";
					$.each(data.stories, function(index, obj) {
						content += "<li class='mui-table-view-cell mui-media'>";
						content += "<a href='detailed.html?id="+obj.id+"'>";
						content += "<img class='mui-media-object mui-pull-right' src='" + obj.images[0] + "'>";
						content += "<div class='mui-media-body'>";
						content += "<p class='mui-ellipsis'>" + obj.title + "</p>";
						content += "</div>";
						content += "</a><br/>";
						content += "</li>";
					});

					$("#content").html(content);


				},
				error: function(e) {
					alert("error");
				}
			});

			//获得slider插件对象
			var gallery = mui('.mui-slider');
			gallery.slider({
				interval: 5000 //自动轮播周期，若为0则不自动播放，默认为0；
			});
			
			mui('body').on('tap', 'a', function() {
				document.location.href = this.href;
			});

			mui('.mui-scroll-wrapper').scroll({
				deceleration: 0.0005 //flick 减速系数，系数越大，滚动速度越慢，滚动距离越小，默认值0.0006
			});
			
		</script>

	</body>
</html>
